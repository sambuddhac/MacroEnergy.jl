<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Constraints · Macro</title><meta name="title" content="Constraints · Macro"/><meta property="og:title" content="Constraints · Macro"/><meta property="twitter:title" content="Constraints · Macro"/><meta name="description" content="Documentation for Macro."/><meta property="og:description" content="Documentation for Macro."/><meta property="twitter:description" content="Documentation for Macro."/><meta property="og:url" content="https://macroenergy.github.io/Macro/stable/User Guide/constraints.html"/><meta property="twitter:url" content="https://macroenergy.github.io/Macro/stable/User Guide/constraints.html"/><link rel="canonical" href="https://macroenergy.github.io/Macro/stable/User Guide/constraints.html"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Macro</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Welcome to Macro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><a class="tocitem" href="../table_of_contents.html">Table of contents</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Getting Started/overview.html">Overview</a></li><li><a class="tocitem" href="../Getting Started/installation.html">Installation</a></li><li><a class="tocitem" href="../Getting Started/first_run.html">First Run</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Tutorials/0_getting_started.html">Getting Started</a></li><li><a class="tocitem" href="../Tutorials/1_running_macro.html">Running Macro</a></li><li><a class="tocitem" href="../Tutorials/2_multisector_modelling.html">Multisector Modelling</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="sectors.html">Sectors</a></li><li><a class="tocitem" href="input_data.html">Input Data</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Assets</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="assets/introduction.html">Macro Asset Library</a></li><li><a class="tocitem" href="assets/battery.html">Battery</a></li><li><a class="tocitem" href="assets/beccselectricity.html">BECCS Electricity</a></li><li><a class="tocitem" href="assets/beccshydrogen.html">BECCS Hydrogen</a></li><li><a class="tocitem" href="assets/electricdac.html">Electric DAC</a></li><li><a class="tocitem" href="assets/electrolyzer.html">Electrolyzer</a></li><li><a class="tocitem" href="assets/fuelcell.html">Fuel Cell</a></li><li><a class="tocitem" href="assets/gasstorage.html">Gas Storage</a></li><li><a class="tocitem" href="assets/hydrogenline.html">Hydrogen Line</a></li><li><a class="tocitem" href="assets/hydropower.html">Hydro Reservoir</a></li><li><a class="tocitem" href="assets/mustrun.html">Must Run</a></li><li><a class="tocitem" href="assets/natgasdaq.html">Natural Gas DAC</a></li><li><a class="tocitem" href="assets/powerline.html">Power Line</a></li><li><a class="tocitem" href="assets/thermalhydrogen.html">Thermal Hydrogen Plant (with and without CCS)</a></li><li><a class="tocitem" href="assets/thermalpower.html">Thermal Power Plant (with and without CCS)</a></li><li><a class="tocitem" href="assets/vre.html">Variable Renewable Energy resources (VRE)</a></li></ul></li><li class="is-active"><a class="tocitem" href="constraints.html">Constraints</a><ul class="internal"><li><a class="tocitem" href="#Balance-constraint"><span>Balance constraint</span></a></li><li><a class="tocitem" href="#Capacity-constraint"><span>Capacity constraint</span></a></li><li><a class="tocitem" href="#CO2-capacity-constraint"><span>CO2 capacity constraint</span></a></li><li><a class="tocitem" href="#Long-duration-storage-constraints"><span>Long-duration storage constraints</span></a></li><li><a class="tocitem" href="#Maximum-capacity-constraint"><span>Maximum capacity constraint</span></a></li><li><a class="tocitem" href="#Maximum-non-served-demand-constraint"><span>Maximum non-served demand constraint</span></a></li><li><a class="tocitem" href="#Maximum-non-served-demand-per-segment-constraint"><span>Maximum non-served demand per segment constraint</span></a></li><li><a class="tocitem" href="#Maximum-storage-level-constraint"><span>Maximum storage level constraint</span></a></li><li><a class="tocitem" href="#Minimum-capacity-constraint"><span>Minimum capacity constraint</span></a></li><li><a class="tocitem" href="#Minimum-flow-constraint"><span>Minimum flow constraint</span></a></li><li><a class="tocitem" href="#Minimum-storage-level-constraint"><span>Minimum storage level constraint</span></a></li><li><a class="tocitem" href="#Minimum-storage-outflow-constraint"><span>Minimum storage outflow constraint</span></a></li><li><a class="tocitem" href="#Minimum-up-and-down-time-constraint"><span>Minimum up and down time constraint</span></a></li><li><a class="tocitem" href="#Must-run-constraint"><span>Must-run constraint</span></a></li><li><a class="tocitem" href="#Ramping-limits-constraint"><span>Ramping limits constraint</span></a></li><li><a class="tocitem" href="#Storage-capacity-constraint"><span>Storage capacity constraint</span></a></li><li><a class="tocitem" href="#Storage-discharge-limit-constraint"><span>Storage discharge limit constraint</span></a></li><li><a class="tocitem" href="#Storage-symmetric-capacity-constraint"><span>Storage symmetric capacity constraint</span></a></li><li><a class="tocitem" href="#Storage-charge-discharge-ratio-constraint"><span>Storage charge discharge ratio constraint</span></a></li><li><a class="tocitem" href="#Storage-max-duration-constraint"><span>Storage max duration constraint</span></a></li><li><a class="tocitem" href="#Storage-min-duration-constraint"><span>Storage min duration constraint</span></a></li></ul></li><li><a class="tocitem" href="output.html">Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Modeler Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Modeler Guide/overview.html">Overview</a></li><li><a class="tocitem" href="../Modeler Guide/build_sectors.html">How to build a sector</a></li><li><a class="tocitem" href="../Modeler Guide/create_example_case.html">How to create an example case</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Developer Guide/overview.html">Overview</a></li><li><a class="tocitem" href="../Developer Guide/type_hierarchy.html">Type hierarchy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">References</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../References/macro_objects.html">Macro Objects</a></li><li><a class="tocitem" href="../References/assets.html">Asset Library</a></li><li><a class="tocitem" href="../References/utilities.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href="constraints.html">Constraints</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="constraints.html">Constraints</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/macroenergy/Macro" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/macroenergy/Macro/blob/master/docs/src/User Guide/constraints.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Macro-Constraint-Library"><a class="docs-heading-anchor" href="#Macro-Constraint-Library">Macro Constraint Library</a><a id="Macro-Constraint-Library-1"></a><a class="docs-heading-anchor-permalink" href="#Macro-Constraint-Library" title="Permalink"></a></h1><p>Currently, Macro includes the following constraints:</p><h2 id="Balance-constraint"><a class="docs-heading-anchor" href="#Balance-constraint">Balance constraint</a><a id="Balance-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{BalanceConstraint, MacroEnergy.AbstractVertex, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{BalanceConstraint, MacroEnergy.AbstractVertex, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::BalanceConstraint, v::AbstractVertex, model::Model)</code></pre><p>Add a balance constraint to the vertex <code>v</code>. </p><ul><li>If <code>v</code> is a <code>Node</code>, a demand balance constraint is added. </li><li>If <code>v</code> is a <code>Transformation</code>, this constraint ensures that the stoichiometric equations linking the input and output flows are correctly balanced.</li></ul><p class="math-container">\[\begin{aligned}
    \sum_{\substack{i\  \in \ \text{balance\_eqs\_ids(v)}, \\ t\  \in \ \text{time\_interval(v)}} } \text{balance\_eq(v, i, t)} = 0.0
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/balance.jl#L7-L20">source</a></section></article><h2 id="Capacity-constraint"><a class="docs-heading-anchor" href="#Capacity-constraint">Capacity constraint</a><a id="Capacity-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Capacity-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{CapacityConstraint, Edge, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{CapacityConstraint, Edge, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::CapacityConstraint, e::Edge, model::Model)</code></pre><p>Add a capacity constraint to the edge <code>e</code>. If the edge is unidirectional, the functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t)} \leq \text{availability(e, t)} \times \text{capacity(e)}
\end{aligned}\]</p><p>If the edge is bidirectional, the constraint is:</p><p class="math-container">\[\begin{aligned}
    i \times \text{flow(e, t)} \leq \text{availability(e, t)} \times \text{capacity(e)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code> and each <code>i</code> in <code>{0, 1}</code>. The function <code>availability</code> returns the time series of the capacity factor of the edge at time <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/capacity.jl#L7-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{CapacityConstraint, EdgeWithUC, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{CapacityConstraint, EdgeWithUC, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::CapacityConstraint, e::EdgeWithUC, model::Model)</code></pre><p>Add a capacity constraint to the edge <code>e</code> with unit commitment. If the edge is unidirectional, the functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \sum_{t \in \text{time\_interval(e)}} \text{flow(e, t)} \leq \text{availability(e, t)} \times \text{capacity(e)} \times \text{ucommit(e, t)}
\end{aligned}\]</p><p>If the edge is bidirectional, the constraint is:</p><p class="math-container">\[\begin{aligned}
    i \times \text{flow(e, t)} \leq \text{availability(e, t)} \times \text{capacity(e)} \times \text{ucommit(e, t)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code> and each <code>i</code> in <code>[-1, 1]</code>. The function <code>availability</code> returns the time series of the availability of the edge at time <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/capacity.jl#L49-L68">source</a></section></article><h2 id="CO2-capacity-constraint"><a class="docs-heading-anchor" href="#CO2-capacity-constraint">CO2 capacity constraint</a><a id="CO2-capacity-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#CO2-capacity-constraint" title="Permalink"></a></h2><p>The CO2 capacity constraint is used to limit the amount of CO2 that can be emitted by a single CO2 node.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{CO2CapConstraint, Node{CO2}, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{CO2CapConstraint, Node{CO2}, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::CO2CapConstraint, n::Node{CO2}, model::Model)</code></pre><p>Constraint the CO2 emissions of CO2 on a CO2 node <code>n</code> to be less than or equal to the value of the <code>rhs_policy</code> for the <code>CO2CapConstraint</code> constraint type. If the <code>price_unmet_policy</code> is also specified, then a slack variable is added to the constraint to allow for the CO2 emissions to exceed the value of the <code>rhs_policy</code> by the amount specified in the <code>price_unmet_policy</code> for the <code>CO2CapConstraint</code> constraint type. Please check the example case in the <code>ExampleSystems</code> folder of Macro, or the <a href="input_data.html#Macro-Input-Data">Macro Input Data</a> section of the documentation for more information on how to specify the <code>rhs_policy</code> and <code>price_unmet_policy</code> for the <code>CO2CapConstraint</code> constraint type.</p><p>Therefore, the functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \sum_{t \in \text{time\_interval(n)}} \text{emissions(n, t)} - \text{price\_unmet\_policy(n)} \times \text{slack(n)} \leq \text{rhs\_policy(n)}
\end{aligned}\]</p><p>&quot;Emissions&quot; in the above equation is the net balance of CO2 flows into and out of the CO2 node <code>n</code>.</p><div class="admonition is-info"><header class="admonition-header">Enabling CO2 emissions for an asset</header><div class="admonition-body"><p><strong>For modelers</strong>: To allow for an asset to contribute to the CO2 emissions of a CO2 node, the asset must have an &quot;emissions&quot; key in its <code>balance_data</code> dictionary. The value of this key should be the <code>emission_rate</code> of the asset.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/co2_cap.jl#L7-L25">source</a></section></article><h2 id="Long-duration-storage-constraints"><a class="docs-heading-anchor" href="#Long-duration-storage-constraints">Long-duration storage constraints</a><a id="Long-duration-storage-constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Long-duration-storage-constraints" title="Permalink"></a></h2><p>These additional constraints (and variables) can be used to ensure that storage levels of long-duration storage systems do not exceed installed capacity over non-representative subperiods. </p><p>For a complete description of the constraints, see the paper: &quot;Improved formulation for long-duration storage in capacity expansion models using representative periods&quot;, Federico Parolin, Paolo Colbertaldo, Ruaridh Macdonald, 2024, <a href="https://doi.org/10.48550/arXiv.2409.19079">https://doi.org/10.48550/arXiv.2409.19079</a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{LongDurationStorageImplicitMinMaxConstraint, LongDurationStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{LongDurationStorageImplicitMinMaxConstraint, LongDurationStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::LongDurationStorageImplicitMinMaxConstraint, g::LongDurationStorage, model::Model)</code></pre><p>Adds constraints to ensure that the storage levels of long-duration storage systems do not exceed installed capacity over non-representative subperiods.</p><p>The functional form of the two constraints are:</p><p class="math-container">\[\begin{aligned}
    \text{storage\_balance(p)} + \text{max\_storage\_level(r)} - \text{storage\_level(tstart(p))} &amp;\leq \text{capacity(g)} \\
    \text{storage\_balance(p)} + \ \text{min\_storage\_level(r)} - \text{storage\_level(tstart(p))} &amp;\geq 0
\end{aligned}\]</p><p>where:</p><ul><li><code>p</code> is a non-representative subperiod.</li><li><code>r</code> is the representative subperiod used to model <code>p</code>.</li><li><code>tstart(p)</code> is the first timestep of the representative subperiod <code>r</code> used to model the non-representative subperiod <code>p</code>.</li><li><code>storage_balance(p)</code> is the balance of the storage resource at the non-representative subperiod <code>p</code> and is defined as </li></ul><p class="math-container">\[\begin{aligned}
    \text{storage\_balance(p)} = (1 - \text{loss\_fraction}) \times \text{storage\_initial(p)} + \frac{\text{flow(discharge\_edge, tstart(p))}}{\text{efficiency(discharge\_edge)}} - \text{efficiency(charge\_edge)} \times \text{flow(charge\_edge, tstart(p))}
\end{aligned}\]</p><ul><li><code>max_storage_level(r)</code> and <code>min_storage_level(r)</code> are the maximum and minimum storage levels for the representative subperiod <code>r</code>, respectively. These are used to constrain the storage levels as follows:</li></ul><p class="math-container">\[\begin{aligned}
    \text{min\_storage\_level(t&#39;)} \leq \text{storage\_level(t)} \leq \text{max\_storage\_level(t&#39;)}
\end{aligned}\]</p><p>for each time <code>t</code> in the time interval of the storage resource <code>g</code>. <code>t&#39;</code> is the corresponding time in the representative subperiod <code>r</code> used to model the time interval of the storage resource <code>g</code>.</p><div class="admonition is-warning"><header class="admonition-header">Only applies to long duration energy storage</header><div class="admonition-body"><p>This constraint only applies to long duration energy storage resources. To model a storage technology as long duration energy storage, the user must set <code>long_duration = true</code> in the <code>Storage</code> component of the asset in the <code>.json</code> file. Check the the file <code>hydropower.json</code> in the <code>ExampleSystems/eastern_us_three_zones</code> folder for an example of how to model a long duration energy storage resource.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/long_duration_storage_implicit_min_max.jl#L14-L51">source</a></section></article><h2 id="Maximum-capacity-constraint"><a class="docs-heading-anchor" href="#Maximum-capacity-constraint">Maximum capacity constraint</a><a id="Maximum-capacity-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-capacity-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MaxCapacityConstraint, Union{AbstractEdge, AbstractStorage}, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MaxCapacityConstraint, Union{AbstractEdge, AbstractStorage}, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MaxCapacityConstraint, y::Union{AbstractEdge,AbstractStorage}, model::Model)</code></pre><p>Add a max capacity constraint to the edge or storage <code>y</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{capacity(y)} \leq \text{max\_capacity(y)}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/max_capacity.jl#L8-L18">source</a></section></article><h2 id="Maximum-non-served-demand-constraint"><a class="docs-heading-anchor" href="#Maximum-non-served-demand-constraint">Maximum non-served demand constraint</a><a id="Maximum-non-served-demand-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-non-served-demand-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MaxNonServedDemandConstraint, Node, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MaxNonServedDemandConstraint, Node, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MaxNonServedDemandConstraint, n::Node, model::Model)</code></pre><p>Add a max non-served demand constraint to the node <code>n</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \sum_{s\ \in\ \text{segments\_nsd(n)}} \text{non\_served\_demand(n, s, t)} \leq \text{demand(n, t)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(n)</code> for the node <code>n</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/max_non_served_demand.jl#L7-L18">source</a></section></article><h2 id="Maximum-non-served-demand-per-segment-constraint"><a class="docs-heading-anchor" href="#Maximum-non-served-demand-per-segment-constraint">Maximum non-served demand per segment constraint</a><a id="Maximum-non-served-demand-per-segment-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-non-served-demand-per-segment-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MaxNonServedDemandPerSegmentConstraint, Node, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MaxNonServedDemandPerSegmentConstraint, Node, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(
    ct::MaxNonServedDemandPerSegmentConstraint,
    n::Node,
    model::Model,
)</code></pre><p>Add a max non-served demand per segment constraint to the node <code>n</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{non\_served\_demand(n, s, t)} \leq \text{max\_non\_served\_demand(n, s)} \times \text{demand(n, t)}
\end{aligned}\]</p><p>for each segment <code>s</code> in <code>segments_non_served_demand(n)</code> and each time <code>t</code> in <code>time_interval(n)</code> for the node <code>n</code>. The function <code>segments_non_served_demand</code> returns the segments of the non-served demand of the node <code>n</code> as defined in the input data <code>nodes.json</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/max_non_served_demand_per_segment.jl#L7-L22">source</a></section></article><h2 id="Maximum-storage-level-constraint"><a class="docs-heading-anchor" href="#Maximum-storage-level-constraint">Maximum storage level constraint</a><a id="Maximum-storage-level-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-storage-level-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MaxStorageLevelConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MaxStorageLevelConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MaxStorageLevelConstraint, g::AbstractStorage, model::Model)</code></pre><p>Add a max storage level constraint to the storage <code>g</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{storage\_level(g, t)} \leq \text{max\_storage\_level(g)} \times \text{capacity(g)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(g)</code> for the storage <code>g</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/max_storage_level.jl#L7-L18">source</a></section></article><h2 id="Minimum-capacity-constraint"><a class="docs-heading-anchor" href="#Minimum-capacity-constraint">Minimum capacity constraint</a><a id="Minimum-capacity-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-capacity-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MinCapacityConstraint, Union{AbstractEdge, AbstractStorage}, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MinCapacityConstraint, Union{AbstractEdge, AbstractStorage}, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MinCapacityConstraint, y::Union{AbstractEdge,AbstractStorage}, model::Model)</code></pre><p>Add a min capacity constraint to the edge or storage <code>y</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{capacity(y)} \geq \text{min\_capacity(y)}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/min_capacity.jl#L7-L17">source</a></section></article><h2 id="Minimum-flow-constraint"><a class="docs-heading-anchor" href="#Minimum-flow-constraint">Minimum flow constraint</a><a id="Minimum-flow-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-flow-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MinFlowConstraint, Edge, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MinFlowConstraint, Edge, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MinFlowConstraint, e::Edge, model::Model)</code></pre><p>Add a min flow constraint to the edge <code>e</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t)} \geq \text{min\_flow\_fraction(e)} \times \text{capacity(e)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This constraint is available only for unidirectional edges.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/min_flow.jl#L7-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MinFlowConstraint, EdgeWithUC, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MinFlowConstraint, EdgeWithUC, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MinFlowConstraint, e::EdgeWithUC, model::Model)</code></pre><p>Add a min flow constraint to the edge <code>e</code> with unit commitment. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t)} \geq \text{min\_flow\_fraction(e)} \times \text{capacity\_size(e)} \times \text{ucommit(e, t)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This constraint is available only for unidirectional edges.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/min_flow.jl#L35-L48">source</a></section></article><h2 id="Minimum-storage-level-constraint"><a class="docs-heading-anchor" href="#Minimum-storage-level-constraint">Minimum storage level constraint</a><a id="Minimum-storage-level-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-storage-level-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MinStorageLevelConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MinStorageLevelConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MinStorageLevelConstraint, g::AbstractStorage, model::Model)</code></pre><p>Add a min storage level constraint to the storage <code>g</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{storage\_level(g, t)} \geq \text{min\_storage\_level(g)} \times \text{capacity(g)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(g)</code> for the storage <code>g</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/min_storage_level.jl#L7-L18">source</a></section></article><h2 id="Minimum-storage-outflow-constraint"><a class="docs-heading-anchor" href="#Minimum-storage-outflow-constraint">Minimum storage outflow constraint</a><a id="Minimum-storage-outflow-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-storage-outflow-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MinStorageOutflowConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MinStorageOutflowConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MinStorageOutflowConstraint, g::AbstractStorage, model::Model)</code></pre><p>Add a min storage outflow constraint to the storage <code>g</code> part of a <code>HydroRes</code> asset. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(spillage\_edge, t)} + \text{flow(discharge\_edge, t)} \geq \text{min\_outflow\_fraction(g)} \times \text{capacity(discharge\_edge)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(g)</code> for the storage <code>g</code>.</p><div class="admonition is-warning"><header class="admonition-header">Only applies to HydroRes assets</header><div class="admonition-body"><p>This constraint only applies to HydroRes assets. It returns a warning if the storage <code>g</code> does not have a spillage edge.  If the discharge edge is the only outflow, you should apply MinFlowConstraint to the discharge edge.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/min_storage_outflow.jl#L7-L22">source</a></section></article><h2 id="Minimum-up-and-down-time-constraint"><a class="docs-heading-anchor" href="#Minimum-up-and-down-time-constraint">Minimum up and down time constraint</a><a id="Minimum-up-and-down-time-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-up-and-down-time-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MinUpTimeConstraint, EdgeWithUC, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MinUpTimeConstraint, EdgeWithUC, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MinUpTimeConstraint, e::EdgeWithUC, model::Model)</code></pre><p>Add a min up time constraint to the edge <code>e</code> with unit commitment. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{ucommit(e, t)} \geq \sum_{h=0}^{\text{min\_up\_time(e)}-1} \text{ustart(e, t-h)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>. The function <a href="../References/utilities.html#MacroEnergy.timestepbefore"><code>timestepbefore</code></a> is used to perform the time wrapping within the subperiods and get the correct time step before <code>t</code>.</p><div class="admonition is-info"><header class="admonition-header">Min up time duration</header><div class="admonition-body"><p>This constraint will throw an error if the minimum up time is longer than the length of one subperiod.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/min_up_down_time.jl#L50-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MinDownTimeConstraint, EdgeWithUC, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MinDownTimeConstraint, EdgeWithUC, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MinDownTimeConstraint, e::EdgeWithUC, model::Model)</code></pre><p>Add a min down time constraint to the edge <code>e</code> with unit commitment. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \frac{\text{capacity(e)}}{\text{capacity\_size(e)}} - \text{ucommit(e, t)} \geq \sum_{h=0}^{\text{min\_down\_time(e)}-1} \text{ushut(e, t-h)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>. The function <a href="../References/utilities.html#MacroEnergy.timestepbefore"><code>timestepbefore</code></a> is used to perform the time wrapping within the subperiods and get the correct time step before <code>t</code>.</p><div class="admonition is-info"><header class="admonition-header">Min down time duration</header><div class="admonition-body"><p>This constraint will throw an error if the minimum down time is longer than the length of one subperiod.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/min_up_down_time.jl#L13-L27">source</a></section></article><h2 id="Must-run-constraint"><a class="docs-heading-anchor" href="#Must-run-constraint">Must-run constraint</a><a id="Must-run-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Must-run-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{MustRunConstraint, Edge, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{MustRunConstraint, Edge, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::MustRunConstraint, e::Edge, model::Model)</code></pre><p>Add a must run constraint to the edge <code>e</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t)} = \text{availability(e, t)} \times \text{capacity(e)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>.</p><div class="admonition is-info"><header class="admonition-header">Must run constraint</header><div class="admonition-body"><p>This constraint is available only for unidirectional edges.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/must_run.jl#L7-L21">source</a></section></article><h2 id="Ramping-limits-constraint"><a class="docs-heading-anchor" href="#Ramping-limits-constraint">Ramping limits constraint</a><a id="Ramping-limits-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Ramping-limits-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{RampingLimitConstraint, Edge, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{RampingLimitConstraint, Edge, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::RampingLimitConstraint, e::Edge, model::Model)</code></pre><p>Add a ramping limit constraint to the edge <code>e</code>. The functional form of the ramping up limit constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t)} - \text{flow(e, t-1)} + \text{regulation\_term(e, t)} + \text{reserves\_term(e, t)} - \text{ramp\_up\_fraction(e)} \times \text{capacity(e)} \leq 0
\end{aligned}\]</p><p>On the other hand, the ramping down limit constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t-1)} - \text{flow(e, t)} + \text{regulation\_term(e, t)} + \text{reserves\_term(e, t)} - \text{ramp\_down\_fraction(e)} \times \text{capacity(e)} \leq 0
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>. The function <a href="../References/utilities.html#MacroEnergy.timestepbefore"><code>timestepbefore</code></a> is used to perform the time wrapping within the subperiods and get the correct time step before <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/ramping_limits.jl#L7-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{RampingLimitConstraint, EdgeWithUC, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{RampingLimitConstraint, EdgeWithUC, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::RampingLimitConstraint, e::EdgeWithUC, model::Model)</code></pre><p>Add a ramping limit constraint to the edge <code>e</code> with unit commitment. The functional form of the ramping up limit constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t)} - \text{flow(e, t-1)} + \text{regulation\_term(e, t)} + \text{reserves\_term(e, t)} - \text{ramp\_up\_fraction(e)} \times \text{capacity\_size(e)} \times (\text{ucommit(e, t)} - \text{ustart(e, t)}) + \text{min(availability(e, t), max(min\_flow\_fraction(e), ramp\_up\_fraction(e)))} \times \text{capacity\_size(e)} \times \text{ustart(e, t)} - \text{min\_flow\_fraction(e)} \times \text{capacity\_size(e)} \times \text{ushut(e, t)} \leq 0
\end{aligned}\]</p><p>On the other hand, the ramping down limit constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e, t-1)} - \text{flow(e, t)} + \text{regulation\_term(e, t)} + \text{reserves\_term(e, t)} - \text{ramp\_down\_fraction(e)} \times \text{capacity\_size(e)} \times (\text{ucommit(e, t)} - \text{ustart(e, t)}) - \text{min\_flow\_fraction(e)} \times \text{capacity\_size(e)} \times \text{ustart(e, t)} + \text{min(availability(e, t), max(min\_flow\_fraction(e), ramp\_down\_fraction(e)))} \times \text{capacity\_size(e)} \times \text{ushut(e, t)} \leq 0
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>. The function <a href="../References/utilities.html#MacroEnergy.timestepbefore"><code>timestepbefore</code></a> is used to perform the time wrapping within the subperiods and get the correct time step before <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/ramping_limits.jl#L59-L79">source</a></section></article><h2 id="Storage-capacity-constraint"><a class="docs-heading-anchor" href="#Storage-capacity-constraint">Storage capacity constraint</a><a id="Storage-capacity-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-capacity-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{StorageCapacityConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{StorageCapacityConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::StorageCapacityConstraint, g::AbstractStorage, model::Model)</code></pre><p>Add a storage capacity constraint to the storage <code>g</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{storage\_level(g, t)} \leq \text{capacity(g)}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(g)</code> for the storage <code>g</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/storage_capacity.jl#L7-L18">source</a></section></article><h2 id="Storage-discharge-limit-constraint"><a class="docs-heading-anchor" href="#Storage-discharge-limit-constraint">Storage discharge limit constraint</a><a id="Storage-discharge-limit-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-discharge-limit-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{StorageDischargeLimitConstraint, Edge, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{StorageDischargeLimitConstraint, Edge, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::StorageDischargeLimitConstraint, e::Edge, model::Model)</code></pre><p>Add a storage discharge limit constraint to the edge <code>e</code> if the start vertex of the edge is a storage. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
   \frac{\text{flow(e, t)}}{\text{efficiency(e)}} \leq \text{storage\_level(start\_vertex(e), timestepbefore(t, 1, subperiods(e)))}
\end{aligned}\]</p><p>for each time <code>t</code> in <code>time_interval(e)</code> for the edge <code>e</code>. The function <a href="../References/utilities.html#MacroEnergy.timestepbefore"><code>timestepbefore</code></a> is used to perform the time wrapping within the subperiods and get the correct time step before <code>t</code>.</p><div class="admonition is-info"><header class="admonition-header">Storage discharge limit constraint</header><div class="admonition-body"><p>This constraint is only applied to edges with a start vertex that is a storage.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/storage_discharge_limit.jl#L8-L22">source</a></section></article><h2 id="Storage-symmetric-capacity-constraint"><a class="docs-heading-anchor" href="#Storage-symmetric-capacity-constraint">Storage symmetric capacity constraint</a><a id="Storage-symmetric-capacity-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-symmetric-capacity-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{StorageSymmetricCapacityConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{StorageSymmetricCapacityConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(
    ct::StorageSymmetricCapacityConstraint,
    g::AbstractStorage,
    model::Model,
)</code></pre><p>Add a storage symmetric capacity constraint to the storage <code>g</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{flow(e\_discharge, t)} + \text{flow(e\_charge, t)} \leq \text{capacity(e\_discharge)}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/storage_symmetric_capacity.jl#L8-L22">source</a></section></article><h2 id="Storage-charge-discharge-ratio-constraint"><a class="docs-heading-anchor" href="#Storage-charge-discharge-ratio-constraint">Storage charge discharge ratio constraint</a><a id="Storage-charge-discharge-ratio-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-charge-discharge-ratio-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{StorageChargeDischargeRatioConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{StorageChargeDischargeRatioConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(
    ct::StorageChargeDischargeRatioConstraint,
    g::AbstractStorage,
    model::Model,
)</code></pre><p>Add a storage charge discharge ratio constraint to the storage <code>g</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{charge\_discharge\_ratio(g)} \times \text{capacity(g.discharge\_edge)} = \text{capacity(g.charge\_edge)}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/storage_charge_discharge_ratio.jl#L7-L21">source</a></section></article><h2 id="Storage-max-duration-constraint"><a class="docs-heading-anchor" href="#Storage-max-duration-constraint">Storage max duration constraint</a><a id="Storage-max-duration-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-max-duration-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{StorageMaxDurationConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{StorageMaxDurationConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::StorageMaxDurationConstraint, g::AbstractStorage, model::Model)</code></pre><p>Add a storage max duration constraint to the storage <code>g</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{capacity(g)} \leq \text{max\_duration(g)} \times \text{capacity(discharge\_edge(g))}
\end{aligned}\]</p><div class="admonition is-info"><header class="admonition-header">Storage max duration constraint</header><div class="admonition-body"><p>This constraint is only applied if the maximum duration is greater than 0.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/storage_duration.jl#L7-L20">source</a></section></article><h2 id="Storage-min-duration-constraint"><a class="docs-heading-anchor" href="#Storage-min-duration-constraint">Storage min duration constraint</a><a id="Storage-min-duration-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-min-duration-constraint" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MacroEnergy.add_model_constraint!-Tuple{StorageMinDurationConstraint, AbstractStorage, Model}" href="#MacroEnergy.add_model_constraint!-Tuple{StorageMinDurationConstraint, AbstractStorage, Model}"><code>MacroEnergy.add_model_constraint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_model_constraint!(ct::StorageMinDurationConstraint, g::AbstractStorage, model::Model)</code></pre><p>Add a storage min duration constraint to the storage <code>g</code>. The functional form of the constraint is:</p><p class="math-container">\[\begin{aligned}
    \text{capacity(g)} \geq \text{min\_duration(g)} \times \text{capacity(discharge\_edge(g))}
\end{aligned}\]</p><div class="admonition is-info"><header class="admonition-header">Storage min duration constraint</header><div class="admonition-body"><p>This constraint is only applied if the minimum duration is greater than 0.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Macro/blob/9fbcc4dd8ba80eaec6d76f65a99fc51a4d7566ce/src/model/constraints/storage_duration.jl#L39-L52">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="assets/vre.html">« Variable Renewable Energy resources (VRE)</a><a class="docs-footer-nextpage" href="output.html">Output »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 11 March 2025 15:34">Tuesday 11 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
